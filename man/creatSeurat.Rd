% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/PACells.R
\name{creatSeurat}
\alias{creatSeurat}
\title{Create a Seurat Object for chromatin accessibility data}
\usage{
creatSeurat(matrix, ranges, meta.data, genome, min.cells = 1)
}
\arguments{
\item{matrix}{A count matrix of chromatin accessibility in features Ã— cells/samples format.
Rows correspond to genomic features (peaks or bins) and columns correspond to cells (scATAC-seq)
or bulk samples (bulk ATAC-seq). Sparse matrices (e.g., \code{dgCMatrix}) are recommended.}

\item{ranges}{A \code{GRanges} object giving the genomic coordinates of the features (peaks/bins).
Its length must equal the number of rows in \code{matrix}, and the order must match the row order
of \code{matrix} exactly.}

\item{meta.data}{A \code{data.frame} containing per-cell/per-sample metadata (e.g., sample ID,
condition, patient ID). Row names should match \code{colnames(matrix)},
so that each column in \code{matrix} can be correctly annotated in the Seurat object.}

\item{genome}{UCSC genome identifier used to label the assay genome (e.g., \code{"hg19"},
\code{"hg38"}). This should be consistent with the coordinate system of \code{ranges}.}

\item{min.cells}{Feature filtering threshold: keep only peaks/bins that are detected in at least
\code{min.cells} columns (cells/samples). This helps remove extremely rare features and reduce noise.
Default is \code{1}, meaning a feature is retained if it appears in more than one cell/sample.
Users can adjust this parameter according to dataset size and sparsity (e.g., using a larger value to apply stricter filtering).}
}
\value{
A Seurat object with an \code{"ATAC"} assay containing a Signac \code{ChromatinAssay}.
The assay stores the input count matrix and genomic ranges, and \code{meta.data} is attached as
cell/sample-level metadata.
}
\description{
This function builds a Seurat object from ATAC-seq count data and is designed
to work for both bulk ATAC-seq and single-cell ATAC-seq.
Input takes a count matrix. The expected format of the input matrix is
features x cells. A set of genomic ranges (peaks or bins) must be supplied
along with the matrix, with the length of the ranges equal to the number of
rows in the matrix.
}
\details{
Conceptually, the function performs two steps:
(1) create a Signac \code{ChromatinAssay} that stores the peak/bin count matrix
together with genomic coordinates and genome annotation; and
(2) wrap the assay into a Seurat object and attach sample/cell-level metadata.
}
