% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/PACells.R
\name{sbisis}
\alias{sbisis}
\title{This function ranks features (e.g., candidate cells) in \code{X} by their marginal association
with the phenotype matrix/vector \code{Y} using Bcor (SBI/BI). It then returns
the top \code{candidate} features as a candidate set.}
\usage{
sbisis(
  Y,
  X,
  candidate = c("large"),
  method = "SBI-SIS-Pvalue",
  parms = list(d1 = 5, d2 = 5, df = 3),
  R = 199,
  parallel = FALSE,
  ncore = NULL
)
}
\arguments{
\item{Y}{Y A numeric vector or matrix of phenotypes for bulk samples. If a matrix, rows correspond
to samples and columns correspond to phenotype variables.}

\item{X}{X A numeric matrix (e.g., similarity matrix). Rows correspond to bulk samples and columns
correspond to features to be screened (e.g., single cells).}

\item{candidate}{candidate Candidate set size. Can be:
\itemize{
  \item a numeric value specifying the number of candidates to keep;
  \item \code{"small"}: keeps approximately \code{round(n/log(n))} candidates (n = number of samples);
  \item \code{"large"}: keeps a large candidate set (up to all available features).
}}

\item{method}{Method for screening procedure.}

\item{parms}{parameters list only available when method = "lm" or "gam".
It contains three parameters: d1, d2, and df.
d1 is the number of initially selected variables,
d2 is the number of variables collection size added in each iteration.
df is degree freedom of basis in generalized additive models playing a role only when method = "gam".
Default:  parms = list(d1 = 5, d2 = 5, df = 3)}

\item{R}{Number of permutations used.}

\item{parallel}{Logical; whether to enable parallel screening using \code{snowfall}.}

\item{ncore}{Integer; number of CPU cores used when \code{parallel = TRUE}. If NULL, snowfall uses its default.}
}
\value{
A list with:
\itemize{
  \item \code{candidate.set}: indices of selected candidate features (columns of \code{X});
  \item \code{candidate.data}: a list containing \code{X} restricted to selected features and the (possibly updated) \code{Y};
  \item \code{candidate.size}: number of selected candidates.
}
}
\description{
Typical usage in PACells:
\itemize{
  \item \code{X}: a similarity matrix with rows = bulk samples and columns = single cells.
  \item \code{Y}: bulk phenotype aligned to the same bulk samples (rows of \code{X}).
}
}
